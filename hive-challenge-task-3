Scenario Based questions:

Will the reducer work or not if you use “Limit 1” in any HiveQL query?
Ans. It will work for aggregation type of queries. and it will not work simple/direct queries.


Suppose I have installed Apache Hive on top of my Hadoop cluster using default metastore configuration. Then, what will happen if we have multiple clients trying to access Hive at the same time? 
Ans. It will not allow to access other client In metastore configuration only one system has access because it will allow one system at one point of time in standalone mode.
In computation hive engine was seperately configured. every system has own jdbc/odbc connector to connect with hive engine.


Suppose, I create a table that contains details of all the transactions done by the customers: CREATE TABLE transaction_details (cust_id INT, amount FLOAT, month STRING, country STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ‘,’ ;
Now, after inserting 50,000 records in this table, I want to know the total revenue generated for each month. But, Hive is taking too much time in processing this query. How will you solve this problem and list the steps that I will be taking in order to do so?

We can create table with partitioned like 
CREATE TABLE pratitioned_transaction_details (cust_id INT, amount FLOAT, month STRING, country STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ‘,’ ;

Set hive.exec.dynamic.partition.mode=nonstrict;

then load the data what ever we need
insert overwrite table pratitioned_transaction_details(month) partition(month) select cusT_id,sum(amount) as total revenue,month,country from transaction_details;


How can you add a new partition for the month December in the above partitioned table?

uing alter we can add new partition
alter table pratitioned_transaction_details add partition(month="dec") location '\location of table';



I am inserting data into a table based on partitions dynamically. But, I received an error – FAILED ERROR IN SEMANTIC ANALYSIS: Dynamic partition strict mode requires at least one static partition column. How will you remove this error?

Enable the dynamic partition
set hive.exec.dynamic.partition=true;
Set hive.exec.dynamic.partition.mode=nonstrict;


suppose, I have a CSV file – ‘sample.csv’ present in ‘/temp’ directory with the following entries:
id first_name last_name email gender ip_address
How will you consume this CSV file into the Hive warehouse using built-in SerDe?

CREATE TABLE emp_details (id INT,first_name string,last_name string,email string,gender string ,ipaddress string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
stored as textfile;


 




